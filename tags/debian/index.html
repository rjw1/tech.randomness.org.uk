<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
 <head>
  <title>bob's tech ramblings: Entries Tagged debian</title> 
  <link rel="stylesheet" type="text/css" media="screen" href="http://tech.randomness.org.uk/style.css">
  <link rel="alternate" title="RSS Feed" href="debian.rss" type="application/rss+xml">
 </head>
 <body>

 <div class="title">
  <h1 class="title1">
       <a href="http://tech.randomness.org.uk/">bob's tech ramblings</a>
      
  </h1>
  
      <h2 class="title2">where i ramble about technical things</h2>
  
 </div>

<div id="sidebar">
Menu
<ul>
<li><a href="http://randomness.org.uk/" rel="me" >website</a>
<li><a href="http://flickr.com/photos/rjw1/" rel="me" >flickr</a>
<li><a href="http://http://pinboard.in/u:rjw1" rel="me" >pinboard</a>
<li><a href="http://twitter.com/rjw1" rel="me" >twitter<a>
<li><a href="http://bob.dreamwidth.org/" rel="me" >dw</a>
<li><a href="http://isitpie.com/">Is it pie</a>
<li><a href="http://london.randomness.org.uk">Randomness Guide to London</a>
</ul>
<p>
<iframe src="http://rcm-uk.amazon.co.uk/e/cm?t=randomness05-21&o=2&p=6&l=st1&mode=books-uk&search=systems%20administration%20linux&nou=1&fc1=000000&lt1=_blank&lc1=9100C9&bg1=000000&f=ifr" marginwidth="0" marginheight="0" width="120" height="150" border="0" frameborder="0" style="border:none;" scrolling="no"></iframe>
</p>

Archive
<ul>

<li>2012
<ul>

<li><a href="http://tech.randomness.org.uk/archive/2012/06/">June (1)</a></li>

</ul></li>

<li>2009
<ul>

<li><a href="http://tech.randomness.org.uk/archive/2009/08/">August (4)</a></li>

</ul></li>

<li>2008
<ul>

<li><a href="http://tech.randomness.org.uk/archive/2008/01/">January (7)</a></li>

<li><a href="http://tech.randomness.org.uk/archive/2008/05/">May (1)</a></li>

<li><a href="http://tech.randomness.org.uk/archive/2008/06/">June (1)</a></li>

<li><a href="http://tech.randomness.org.uk/archive/2008/08/">August (1)</a></li>

</ul></li>

<li>2007
<ul>

<li><a href="http://tech.randomness.org.uk/archive/2007/03/">March (1)</a></li>

<li><a href="http://tech.randomness.org.uk/archive/2007/04/">April (2)</a></li>

<li><a href="http://tech.randomness.org.uk/archive/2007/12/">December (1)</a></li>

</ul></li>

<li>2006
<ul>

<li><a href="http://tech.randomness.org.uk/archive/2006/07/">July (3)</a></li>

<li><a href="http://tech.randomness.org.uk/archive/2006/09/">September (1)</a></li>

<li><a href="http://tech.randomness.org.uk/archive/2006/10/">October (1)</a></li>

</ul></li>

</ul>



Tags
<ul>

 <li><a href="http://tech.randomness.org.uk/tags/alerting">alerting (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/apache">apache (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/apple">apple (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/apt">apt (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/backups">backups (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/bash">bash (4)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/blog">blog (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/bob">bob (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/books">books (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/cache">cache (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/capistrano">capistrano (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/catalyst">catalyst (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/certificate">certificate (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/chronicle">chronicle (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/cisco">cisco (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/cpan">cpan (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/cron">cron (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/ddos">ddos (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/dean">dean (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/debian">debian (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/debs">debs (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/deployment">deployment (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/drbd">drbd (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/dwilson">dwilson (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/email">email (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/feeds">feeds (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/free">free (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/geodata">geodata (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/google">google (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/gps">gps (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/ha">ha (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/hate">hate (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/heartbeat">heartbeat (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/hints">hints (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/holding">holding (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/hpux">hpux (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/hsrp">hsrp (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/humans">humans (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/install">install (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/ipv6">ipv6 (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/kml">kml (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/linux">linux (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/london.pm">london.pm (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/macosx">macosx (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/mailinglist">mailinglist (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/mailman">mailman (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/mapping">mapping (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/mod_rewrite">mod_rewrite (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/moose">moose (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/nagios">nagios (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/nokia">nokia (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/openbsd">openbsd (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/openguides">openguides (3)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/packages">packages (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/patch">patch (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/perl">perl (4)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/plagger">plagger (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/planet">planet (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/pub">pub (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/raid">raid (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/recipe">recipe (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/repo">repo (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/rgl">rgl (3)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/routers">routers (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/rss">rss (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/rules">rules (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/scripts">scripts (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/shiny">shiny (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/signed">signed (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/software">software (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/solaris">solaris (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/ssh">ssh (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/ssl">ssl (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/stupid">stupid (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/svn">svn (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/switching">switching (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/testing">testing (2)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/tip">tip (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/tricks">tricks (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/ubuntu">ubuntu (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/web">web (1)</a></li>

 <li><a href="http://tech.randomness.org.uk/tags/zimki">zimki (1)</a></li>

</ul>

</div>

<div id="content">
 <p>Entries tagged "debian".</p>




<div class="entry">
 <div class="title">
<h1><a href="http://tech.randomness.org.uk/Creating_an_apt_repo_.html">Creating an apt repo.</a></h1>
 </div>
 <div class="date">
  22nd May 2008
 </div>

 <div class="body">
  <p>So recently I've backported[1] a couple of debian packages and needed somewhere to serve them from. The current work apt repo scares me so I followed <a href="http://blog.unixdaemon.net/">Dean's</a> useful <a href="http://blog.unixdaemon.net/cgi-bin/blosxom.pl/operatingsystems/linux/debian/personal_apt_repo_initial.html">guide</a> to setting one up instead. It worked very nicely and wasn't pain.</p>
<p><small>[1] post to come hopefully</small></p>

 </div>
 <div class="tags">
 

 
  Tags: <a href="http://tech.randomness.org.uk/tags/apt">apt</a>, <a href="http://tech.randomness.org.uk/tags/debian">debian</a>, <a href="http://tech.randomness.org.uk/tags/dwilson">dwilson</a>, <a href="http://tech.randomness.org.uk/tags/packages">packages</a>, <a href="http://tech.randomness.org.uk/tags/repo">repo</a>.
 
 </div>
</div>
<hr>
<div class="padding"></div>

<div class="entry">
 <div class="title">
<h1><a href="http://tech.randomness.org.uk/Setting_up_a_Signed_apt_repo.html">Setting up a Signed apt repo</a></h1>
 </div>
 <div class="date">
   7th August 2009
 </div>

 <div class="body">
  <p>So you've set up a apt repository following dean's excellant <a href="http://blog.unixdaemon.net/cgi-bin/blosxom.pl/operatingsystems/linux/debian/personal_apt_repo_initial.html">instructions</a> and youve tried to install a package and got the following warning</p>
<pre>WARNING: The following packages cannot be authenticated!</pre>
<p>At this point you have several choices:-
<ul>
<li>press yes and carry on.(not that useful if youre using puppet to install stuff)</li>
<li><code>echo "APT::Get::AllowUnauthenticated 1;" >> /etc/apt/apt.conf.d/99unauth</code></li>
<li> Set up a <a href="http://wiki.debian.org/SecureApt">secure repository</a></li>
</ul>
<p>Lets go with setting up a secure repository.
<ul>
<li>Make yourself a gpg key - <code>gpg --gen-key</code></li>
<li>Export your public key to a file - <code>gpg --armor --export $keyid >public.key</code>. You will need this later</li>
<li>Create an apt-release.conf containing <code>APT::FTPArchive::Release::Suite "etch";</code><small>(Im behind and should have written this post a year ago)</small> in your repository base.</li>
<li>Generate a release file - <code>apt-ftparchive -c apt-release.conf release dists/etch/ > dists/etch/Release</code></li>
<li>Create a signed version - <code>gpg --sign -ba -o dists/etch/Release.gpg dists/etch/Release</code></li>
</ul>
Your repository is now secure. Now you need to tell your machines about your key or apt-get will emit <pre>W: GPG error: http://debianrepo etch Release: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY $KEYID</pre>
To do this manually you can take the public.key you generated earlier and copy it to your machines and then run <code>apt-key add public.key</code></p>
<p>
Of course in this day and age doing things like that for all your machines would be tedious so I use <a href="http://reductivelabs.com/products/puppet/">puppet</a> with a class something like the following.</p>
<pre>
class aptkey {

  file { "/etc/apt/public.key":
    mode   => 440,
    owner  => root,
    group  => root,
    source => [
        "puppet://puppet/host/public.key",
        "puppet://puppet/files/public.key"
        ],
  }
  exec { "install-key":
     command => "/usr/bin/apt-key add /etc/apt/public.key",
     require => File["/etc/apt/public.key"],
     unless  => "/usr/bin/apt-key list | /bin/grep -q 'firstname.lastname'";
  }
  exec { "key-update":
     command => "/usr/bin/apt-get update",
     require => Exec["install-key"],
  }
}
</pre>



 </div>
 <div class="tags">
 

 
  Tags: <a href="http://tech.randomness.org.uk/tags/apt">apt</a>, <a href="http://tech.randomness.org.uk/tags/debian">debian</a>, <a href="http://tech.randomness.org.uk/tags/debs">debs</a>, <a href="http://tech.randomness.org.uk/tags/signed">signed</a>.
 
 </div>
</div>
<hr>
<div class="padding"></div>

</div>


<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1507315-2");
pageTracker._trackPageview();
</script>


</body>
</html>
